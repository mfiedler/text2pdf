#!/bin/bash
# Converts ASCII text files to PDf
set -o errexit
set -o nounset

A2PS_ARGS="--tabsize=4 --portrait --highlight-level=heavy --prologue=color --columns=1 --font-size=11 --media=A4 --chars-per-line=80 --line-numbers=1"
PS2PDF_ARGS="-sPAPERSIZE=a4 -dOptimize=true -dEmbedAllFonts=true"
		

# check for commandline arguments
if [ "$#" = 0 ]
then
	echo "No input files specified."
	echo "usage: text2pdf input_file..."
fi


# do conversion
for FILE in "$@"
do
if [ -f "$FILE" ]
	then
	    if [ -r "${FILE}" ]
	    then
		    a2ps ${A2PS_ARGS} --output=- "$FILE" | ps2pdf ${PS2PDF_ARGS} - "${FILE}.pdf"
		    echo "${FILE} converted. Saved to ${FILE}.pdf"
	    else
	        echo "${FILE} skipped: Cannot read file ${FILE}"
	        exit -1
        fi
	else
		echo "${FILE} skipped: Not a regular file"
	fi

done
